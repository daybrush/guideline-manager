{"version":3,"file":"guides.min.js","sources":["../../react-guides/dist/guides.esm.js","../src/index.umd.ts","../src/consts.ts","../src/InnerGuides.tsx","../src/Guides.tsx","../src/GuidesManager.tsx"],"sourcesContent":["/*\nCopyright (c) 2019 Daybrush\nname: @scena/react-guides\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/guides/blob/master/packages/react-guides\nversion: 0.28.1\n*/\nimport { createElement, createRef, PureComponent } from 'react';\nimport Ruler, { PROPERTIES as PROPERTIES$1 } from '@scena/react-ruler';\nimport { prefixNames, prefixCSS, ref, refs } from 'framework-utils';\nimport DragScroll from '@scena/dragscroll';\nimport Gesto from 'gesto';\nimport { styled } from 'react-css-styled';\nimport { hasClass, addClass, removeClass } from '@daybrush/utils';\nimport { getDistElementMatrix, calculateMatrixDist } from 'css-to-mat';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\nfunction __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nfunction prefix() {\n  var classNames = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    classNames[_i] = arguments[_i];\n  }\n\n  return prefixNames.apply(void 0, __spreadArray([\"scena-guides-\"], classNames, false));\n}\n\nvar ADDER = prefix(\"guide\", \"adder\");\nvar GUIDES = prefix(\"guides\");\nvar GUIDE = prefix(\"guide\");\nvar DRAGGING = prefix(\"dragging\");\nvar DISPLAY_DRAG = prefix(\"display-drag\");\nvar GUIDES_CSS = prefixCSS(\"scena-guides-\", \"\\n{\\n    position: relative;\\n    width: 100%;\\n    height: 100%;\\n}\\ncanvas {\\n    position: relative;\\n}\\n.guide-origin {\\n    position: absolute;\\n    width: 1px;\\n    height: 1px;\\n    top: 0;\\n    left: 0;\\n    opacity: 0;\\n}\\n.guides {\\n    position: absolute;\\n    bottom: 0;\\n    right: 0;\\n    will-change: transform;\\n    z-index: 2000;\\n}\\n.guide-pos {\\n    position: absolute;\\n    font-weight: bold;\\n    font-size: 12px;\\n    color: #f33;\\n}\\n.horizontal .guide-pos {\\n    bottom: 100%;\\n    left: 50%;\\n    transform: translate(-50%);\\n}\\n.vertical .guide-pos {\\n    left: calc(100% + 2px);\\n    top: 50%;\\n    transform: translateY(-50%);\\n}\\n.display-drag {\\n    position: absolute;\\n    will-change: transform;\\n    z-index: 2000;\\n    font-weight: bold;\\n    font-size: 12px;\\n    display: none;\\n    left: 20px;\\n    top: -20px;\\n    color: #f33;\\n}\\n:host.horizontal .guides {\\n    width: 100%;\\n    height: 0;\\n}\\n:host.vertical .guides {\\n    height: 100%;\\n    width: 0;\\n}\\n:host.horizontal canvas {\\n    cursor: ns-resize;\\n}\\n:host.vertical canvas {\\n    cursor: ew-resize;\\n}\\n.guide {\\n    position: absolute;\\n    background: #f33;\\n    z-index: 2;\\n}\\n.guide.dragging:before {\\n    position: absolute;\\n    content: \\\"\\\";\\n    width: 100%;\\n    height: 100%;\\n    top: 50%;\\n    left: 50%;\\n    transform: translate(-50%, -50%);\\n}\\n:host.horizontal .guide {\\n    width: 100%;\\n    height: 1px;\\n    cursor: row-resize;\\n}\\n:host.vertical .guide {\\n    width: 1px;\\n    height: 100%;\\n    cursor: col-resize;\\n}\\n.mobile :host.horizontal .guide {\\n    transform: scale(1, 2);\\n}\\n.mobile :host.vertical .guide {\\n    transform: scale(2, 1);\\n}\\n:host.horizontal .guide:before {\\n    height: 20px;\\n}\\n:host.vertical .guide:before {\\n    width: 20px;\\n}\\n.adder {\\n    display: none;\\n}\\n.adder.dragging {\\n    display: block;\\n}\\n\");\nvar PROPERTIES = __spreadArray([\"className\", \"rulerStyle\", 'snapThreshold', \"snaps\", \"displayDragPos\", \"cspNonce\", 'dragPosFormat', \"defaultGuides\", \"showGuides\", \"scrollOptions\", \"guideStyle\", \"guidesOffset\", \"digit\", \"defaultGuidesPos\", \"dragGuideStyle\", \"displayGuidePos\", \"guidePosFormat\", \"guidePosStyle\", \"lockGuides\", \"guidesZoom\"], PROPERTIES$1, true);\nvar METHODS = [\"getGuides\", \"loadGuides\", \"scroll\", \"scrollGuides\", \"resize\", \"getElement\", \"getRulerElement\", \"forceUpdate\", \"getRulerScrollPos\", \"getGuideScrollPos\", \"zoomTo\", \"drawRuler\"];\nvar EVENTS = [\"changeGuides\", \"requestScroll\", \"dragStart\", \"drag\", \"dragEnd\", \"clickRuler\"];\n\nvar GuidesElement = styled(\"div\", GUIDES_CSS);\n\nvar Guides =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(Guides, _super);\n\n  function Guides(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = {\n      guides: []\n    };\n    _this.scrollPos = 0;\n    _this.managerRef = createRef();\n    _this.guideElements = [];\n    _this._isFirstMove = false;\n    _this._zoom = 1;\n    _this._guidesZoom = 1;\n    _this._observer = null;\n\n    _this.onDragStart = function (e) {\n      var datas = e.datas,\n          inputEvent = e.inputEvent;\n      _this._isFirstMove = true;\n\n      _this.movePos(e);\n      /**\n       * When the drag starts, the dragStart event is called.\n       * @memberof Guides\n       * @event dragStart\n       * @param {OnDragStart} - Parameters for the dragStart event\n       */\n\n\n      _this.props.onDragStart(__assign(__assign({}, e), {\n        dragElement: datas.target\n      }));\n\n      if (!_this.gesto.isFlag()) {\n        return;\n      }\n\n      inputEvent.stopPropagation();\n      inputEvent.preventDefault();\n\n      _this._startDragScroll(e);\n    };\n\n    _this._onDrag = function (e) {\n      if (_this._isFirstMove) {\n        _this._isFirstMove = false;\n        addClass(e.datas.target, DRAGGING);\n      }\n\n      var nextPos = _this.movePos(e);\n      /**\n       * When dragging, the drag event is called.\n       * @memberof Guides\n       * @event drag\n       * @param {OnDrag} - Parameters for the drag event\n       */\n\n\n      _this.props.onDrag(__assign(__assign({}, e), {\n        dragElement: e.datas.target\n      }));\n\n      if (!_this.gesto.isFlag()) {\n        _this._endDragScroll(e);\n\n        return;\n      }\n\n      _this._dragScroll(e);\n\n      return nextPos;\n    };\n\n    _this.onDragEnd = function (e) {\n      var datas = e.datas,\n          isDouble = e.isDouble,\n          distX = e.distX,\n          distY = e.distY;\n\n      var pos = _this.movePos(e);\n\n      var guides = _this.state.guides;\n      var _a = _this.props,\n          onChangeGuides = _a.onChangeGuides,\n          displayDragPos = _a.displayDragPos,\n          digit = _a.digit,\n          lockGuides = _a.lockGuides,\n          guidesOffset = _a.guidesOffset;\n      var zoom = _this._guidesZoom;\n      var guidePos = parseFloat((pos / zoom).toFixed(digit || 0));\n      var baseScrollPos = _this.scrollPos - (guidesOffset || 0);\n\n      if (displayDragPos) {\n        _this.displayElement.style.cssText += \"display: none;\";\n      }\n\n      removeClass(datas.target, DRAGGING);\n      /**\n       * When the drag finishes, the dragEnd event is called.\n       * @memberof Guides\n       * @event dragEnd\n       * @param {OnDragEnd} - Parameters for the dragEnd event\n       */\n\n      _this.props.onDragEnd(__assign(__assign({}, e), {\n        dragElement: datas.target\n      }));\n\n      _this._endDragScroll(e);\n\n      if (datas.fromRuler) {\n        if (_this._isFirstMove) {\n          /**\n           * When click the ruler, the click ruler is called.\n           * @memberof Guides\n           * @event clickRuler\n           * @param {OnClickRuler} - Parameters for the clickRuler event\n           */\n          _this.props.onClickRuler(__assign(__assign({}, e), {\n            pos: 0\n          }));\n        }\n\n        if (guidePos >= baseScrollPos && guides.indexOf(guidePos) < 0) {\n          _this.setState({\n            guides: __spreadArray(__spreadArray([], guides, true), [guidePos], false)\n          }, function () {\n            /**\n             * The `changeGuides` event occurs when the guideline is added / removed / changed.\n             * @memberof Guides\n             * @event changeGuides\n             * @param {OnChangeGuides} - Parameters for the changeGuides event\n             */\n            onChangeGuides({\n              guides: _this.state.guides,\n              distX: distX,\n              distY: distY,\n              index: guides.length,\n              isAdd: true,\n              isRemove: false,\n              isChange: false\n            });\n          });\n        }\n      } else {\n        var index_1 = parseFloat(datas.target.getAttribute(\"data-index\"));\n        var isRemove_1 = false;\n        var isChange_1 = false;\n        guides = __spreadArray([], guides, true);\n        var guideIndex = guides.indexOf(guidePos);\n\n        if (isDouble || guidePos < baseScrollPos || guideIndex > -1 && guideIndex !== index_1) {\n          if (lockGuides && (lockGuides === true || lockGuides.indexOf(\"remove\") > -1)) {\n            return;\n          }\n\n          guides.splice(index_1, 1);\n          isRemove_1 = true;\n        } else if (guideIndex > -1) {\n          return;\n        } else {\n          if (lockGuides && (lockGuides === true || lockGuides.indexOf(\"change\") > -1)) {\n            return;\n          }\n\n          guides[index_1] = guidePos;\n          isChange_1 = true;\n        }\n\n        _this.setState({\n          guides: guides\n        }, function () {\n          var nextGuides = _this.state.guides;\n          onChangeGuides({\n            distX: distX,\n            distY: distY,\n            guides: nextGuides,\n            isAdd: false,\n            index: index_1,\n            isChange: isChange_1,\n            isRemove: isRemove_1\n          });\n        });\n      }\n    };\n\n    _this._onCheck = function () {\n      _this.resize();\n    };\n\n    _this.state.guides = props.defaultGuides || [];\n    _this.scrollPos = props.defaultGuidesPos || 0;\n    return _this;\n  }\n\n  var __proto = Guides.prototype;\n\n  __proto.render = function () {\n    var _a = this.props,\n        className = _a.className,\n        type = _a.type,\n        zoom = _a.zoom,\n        guidesZoom = _a.guidesZoom,\n        style = _a.style,\n        rulerStyle = _a.rulerStyle,\n        displayDragPos = _a.displayDragPos,\n        cspNonce = _a.cspNonce,\n        dragGuideStyle = _a.dragGuideStyle,\n        _b = _a.guidePosStyle,\n        guidePosStyle = _b === void 0 ? {} : _b;\n    var props = this.props;\n    var translateName = this.getTranslateName();\n    var rulerProps = {};\n    PROPERTIES$1.forEach(function (name) {\n      if (name === \"style\" || name === \"warpSelf\" || name === \"useResizeObserver\") {\n        return;\n      }\n\n      rulerProps[name] = props[name];\n    });\n    this._zoom = zoom;\n    this._guidesZoom = guidesZoom || zoom;\n    console.log(type, zoom, guidesZoom);\n    return createElement(GuidesElement, {\n      ref: this.managerRef,\n      cspNonce: cspNonce,\n      className: \"\".concat(prefix(\"manager\", type), \" \").concat(className),\n      style: style\n    }, createElement(\"div\", {\n      className: prefix(\"guide-origin\"),\n      ref: ref(this, \"originElement\")\n    }), createElement(Ruler, __assign({\n      ref: ref(this, \"ruler\"),\n      style: rulerStyle\n    }, rulerProps)), createElement(\"div\", {\n      className: GUIDES,\n      ref: ref(this, \"guidesElement\"),\n      style: {\n        transform: \"\".concat(translateName, \"(\").concat(-this.scrollPos * this._guidesZoom, \"px)\")\n      }\n    }, displayDragPos && createElement(\"div\", {\n      className: DISPLAY_DRAG,\n      ref: ref(this, \"displayElement\"),\n      style: guidePosStyle || {}\n    }), createElement(\"div\", {\n      className: ADDER,\n      ref: ref(this, \"adderElement\"),\n      style: dragGuideStyle\n    }), this.renderGuides()));\n  };\n  /**\n   * Draw ruler\n   */\n\n\n  __proto.drawRuler = function (options) {\n    this.ruler.draw(options);\n  };\n\n  __proto.renderGuides = function () {\n    var _this = this;\n\n    var props = this.props;\n    var _a = props,\n        type = _a.type,\n        showGuides = _a.showGuides,\n        guideStyle = _a.guideStyle,\n        displayGuidePos = _a.displayGuidePos,\n        _b = _a.guidePosStyle,\n        guidePosStyle = _b === void 0 ? {} : _b,\n        guidesOffset = _a.guidesOffset;\n    var zoom = this._guidesZoom;\n    var translateName = this.getTranslateName();\n    var guides = this.state.guides;\n\n    var guidePosFormat = props.guidePosFormat || props.dragPosFormat || function (v) {\n      return v;\n    };\n\n    this.guideElements = [];\n\n    if (showGuides) {\n      return guides.map(function (pos, i) {\n        var guidePos = pos + (guidesOffset || 0);\n        return createElement(\"div\", {\n          className: prefix(\"guide\", type),\n          ref: refs(_this, \"guideElements\", i),\n          key: i,\n          \"data-index\": i,\n          \"data-pos\": pos,\n          style: __assign(__assign({}, guideStyle), {\n            transform: \"\".concat(translateName, \"(\").concat(guidePos * zoom, \"px) translateZ(0px)\")\n          })\n        }, displayGuidePos && createElement(\"div\", {\n          className: prefix(\"guide-pos\"),\n          style: guidePosStyle || {}\n        }, guidePosFormat(pos)));\n      });\n    }\n\n    return;\n  };\n\n  __proto.componentDidMount = function () {\n    var _this = this;\n\n    this.gesto = new Gesto(this.managerRef.current, {\n      container: document.body\n    }).on(\"dragStart\", function (e) {\n      var _a = _this.props,\n          type = _a.type,\n          lockGuides = _a.lockGuides;\n      var zoom = _this._guidesZoom;\n\n      if (lockGuides === true) {\n        e.stop();\n        return;\n      }\n\n      var inputEvent = e.inputEvent;\n      var target = inputEvent.target;\n      var datas = e.datas;\n      var canvasElement = _this.ruler.canvasElement;\n      var guidesElement = _this.guidesElement;\n      var isHorizontal = type === \"horizontal\";\n\n      var originRect = _this.originElement.getBoundingClientRect();\n\n      var matrix = getDistElementMatrix(_this.managerRef.current);\n      var offsetPos = calculateMatrixDist(matrix, [e.clientX - originRect.left, e.clientY - originRect.top]);\n      offsetPos[0] -= guidesElement.offsetLeft;\n      offsetPos[1] -= guidesElement.offsetTop;\n      offsetPos[isHorizontal ? 1 : 0] += _this.scrollPos * zoom;\n      datas.offsetPos = offsetPos;\n      datas.matrix = matrix;\n      var isLockAdd = lockGuides && lockGuides.indexOf(\"add\") > -1;\n      var isLockRemove = lockGuides && lockGuides.indexOf(\"remove\") > -1;\n      var isLockChange = lockGuides && lockGuides.indexOf(\"change\") > -1;\n\n      if (target === canvasElement) {\n        if (isLockAdd) {\n          e.stop();\n          return;\n        }\n\n        datas.fromRuler = true;\n        datas.target = _this.adderElement; // add\n      } else if (hasClass(target, GUIDE)) {\n        if (isLockRemove && isLockChange) {\n          e.stop();\n          return;\n        }\n\n        datas.target = target; // change\n      } else {\n        e.stop();\n        return false;\n      }\n\n      _this.onDragStart(e);\n    }).on(\"drag\", this._onDrag).on(\"dragEnd\", this.onDragEnd);\n\n    if (this.props.useResizeObserver) {\n      this._observer = new ResizeObserver(this._onCheck);\n\n      this._observer.observe(this.guidesElement, {\n        box: \"border-box\"\n      });\n\n      this._observer.observe(this.getRulerElement(), {\n        box: \"border-box\"\n      });\n    } else {\n      this._onCheck();\n    }\n  };\n\n  __proto.componentWillUnmount = function () {\n    var _a;\n\n    this.gesto.unset();\n    (_a = this._observer) === null || _a === void 0 ? void 0 : _a.disconnect();\n  };\n\n  __proto.componentDidUpdate = function (prevProps) {\n    var nextGuides = this.props.defaultGuides;\n\n    if (prevProps.defaultGuides !== nextGuides) {\n      // to dynamically update guides from code rather than dragging guidelines\n      this.setState({\n        guides: nextGuides || []\n      });\n    }\n  };\n  /**\n   * Load the current guidelines.\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.loadGuides = function (guides) {\n    this.setState({\n      guides: guides\n    });\n  };\n  /**\n   * Get current guidelines.\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.getGuides = function () {\n    return this.state.guides;\n  };\n  /**\n   * Scroll the positions of the guidelines opposite the ruler.\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.scrollGuides = function (pos, nextZoom) {\n    if (nextZoom === void 0) {\n      nextZoom = this._guidesZoom;\n    }\n\n    this._setZoom({\n      guidesZoom: nextZoom\n    });\n\n    var translateName = this.getTranslateName();\n    var guidesElement = this.guidesElement;\n    this.scrollPos = pos;\n    guidesElement.style.transform = \"\".concat(translateName, \"(\").concat(-pos * nextZoom, \"px)\");\n    var guides = this.state.guides;\n    var guidesOffset = this.props.guidesOffset || 0;\n    this.guideElements.forEach(function (el, i) {\n      if (!el) {\n        return;\n      }\n\n      var guidePos = guides[i] + (guidesOffset || 0);\n      el.style.transform = \"\".concat(translateName, \"(\").concat(guidePos * nextZoom, \"px) translateZ(0px)\");\n      el.style.display = -pos + guidePos < 0 ? \"none\" : \"block\";\n    });\n  };\n  /**\n   * Set to the next zoom.\n   * @memberof Guides\n   * @since 0.22.0\n   * @param nextZoom - next zoom\n   */\n\n\n  __proto.zoomTo = function (nextZoom, nextGuidesZoom) {\n    if (nextGuidesZoom === void 0) {\n      nextGuidesZoom = nextZoom;\n    }\n\n    this.scroll(this.getRulerScrollPos(), nextZoom);\n    this.scrollGuides(this.getGuideScrollPos(), nextGuidesZoom);\n  };\n  /**\n   * Get Guides DOM Element\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.getElement = function () {\n    return this.managerRef.current;\n  };\n  /**\n   * Get Ruler DOM Element\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.getRulerElement = function () {\n    return this.ruler.canvasElement;\n  };\n  /**\n   * Scroll position of guides (horizontal: y, vertical: x)\n   */\n\n\n  __proto.getGuideScrollPos = function () {\n    return this.scrollPos;\n  };\n  /**\n   * Scroll position of the ruler (horizontal: x, vertical: y)\n   */\n\n\n  __proto.getRulerScrollPos = function () {\n    return this.ruler.getScrollPos();\n  };\n  /**\n   * Scroll the position of the ruler.\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.scroll = function (pos, nextZoom) {\n    if (nextZoom === void 0) {\n      nextZoom = this._zoom;\n    }\n\n    this._setZoom({\n      zoom: nextZoom\n    });\n\n    this.ruler.scroll(pos, nextZoom);\n  };\n  /**\n   * Recalculate the size of the ruler.\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.resize = function (nextZoom) {\n    if (nextZoom === void 0) {\n      nextZoom = this._zoom;\n    }\n\n    this._setZoom({\n      zoom: nextZoom\n    });\n\n    this.ruler.resize(nextZoom);\n  };\n\n  __proto.movePos = function (e) {\n    var datas = e.datas,\n        distX = e.distX,\n        distY = e.distY;\n    var props = this.props;\n    var type = props.type,\n        snaps = props.snaps,\n        snapThreshold = props.snapThreshold,\n        displayDragPos = props.displayDragPos,\n        digit = props.digit;\n    var guidesOffset = props.guidesOffset || 0;\n    var zoom = this._guidesZoom;\n\n    var dragPosFormat = props.dragPosFormat || function (v) {\n      return v;\n    };\n\n    var isHorizontal = type === \"horizontal\";\n    var matrixPos = calculateMatrixDist(datas.matrix, [distX, distY]);\n    var offsetPos = datas.offsetPos;\n    var offsetX = matrixPos[0] + offsetPos[0];\n    var offsetY = matrixPos[1] + offsetPos[1];\n    var guidesZoomOffset = guidesOffset * zoom;\n    var nextPos = Math.round(isHorizontal ? offsetY : offsetX) - guidesOffset;\n    var guidePos = parseFloat((nextPos / zoom).toFixed(digit || 0));\n    var guideSnaps = snaps.slice().sort(function (a, b) {\n      return Math.abs(guidePos - a) - Math.abs(guidePos - b);\n    });\n\n    if (guideSnaps.length && Math.abs(guideSnaps[0] * zoom - nextPos) < snapThreshold) {\n      guidePos = guideSnaps[0];\n      nextPos = guidePos * zoom;\n    }\n\n    if (!datas.fromRuler || !this._isFirstMove) {\n      if (displayDragPos) {\n        var displayPos = type === \"horizontal\" ? [offsetX, nextPos + guidesZoomOffset] : [nextPos + guidesZoomOffset, offsetY];\n        this.displayElement.style.cssText += \"display: block;\" + \"transform: translate(-50%, -50%) \" + \"translate(\".concat(displayPos.map(function (v) {\n          return \"\".concat(v, \"px\");\n        }).join(\", \"), \")\");\n        this.displayElement.innerHTML = \"\".concat(dragPosFormat(guidePos));\n      }\n\n      var target = datas.target;\n      target.setAttribute(\"data-pos\", guidePos);\n      target.style.transform = \"\".concat(this.getTranslateName(), \"(\").concat(nextPos + guidesOffset * zoom, \"px)\");\n    }\n\n    return nextPos;\n  };\n\n  __proto.getTranslateName = function () {\n    return this.props.type === \"horizontal\" ? \"translateY\" : \"translateX\";\n  };\n\n  __proto._startDragScroll = function (e) {\n    var _this = this;\n\n    var scrollOptions = this.props.scrollOptions;\n\n    if (!scrollOptions) {\n      return;\n    }\n\n    var datas = e.datas;\n    var dragScroll = new DragScroll();\n    datas.dragScroll = dragScroll;\n    dragScroll.on(\"scroll\", function (_a) {\n      var _b, _c;\n\n      var container = _a.container,\n          direction = _a.direction;\n      /**\n       * If scroll can be triggered through drag, the `requestScroll` event is fired.\n       * @memberof Guides\n       * @event requestScroll\n       * @param {OnRequestScroll} - Parameters for the `requestScroll` event\n       */\n\n      (_c = (_b = _this.props).onRequestScroll) === null || _c === void 0 ? void 0 : _c.call(_b, {\n        container: container,\n        direction: direction\n      });\n    }).on(\"move\", function (_a) {\n      var offsetX = _a.offsetX,\n          offsetY = _a.offsetY,\n          inputEvent = _a.inputEvent;\n\n      _this.gesto.scrollBy(offsetX, offsetY, inputEvent.inputEvent, true);\n    });\n    dragScroll.dragStart(e, {\n      container: scrollOptions.container\n    });\n  };\n\n  __proto._dragScroll = function (e) {\n    var scrollOptions = this.props.scrollOptions;\n\n    if (!scrollOptions) {\n      return;\n    }\n\n    var dragScroll = e.datas.dragScroll;\n    dragScroll.drag(e, scrollOptions);\n  };\n\n  __proto._endDragScroll = function (e) {\n    var _a;\n\n    (_a = e.datas.dragScroll) === null || _a === void 0 ? void 0 : _a.dragEnd();\n    e.datas.dragScroll = null;\n  };\n\n  __proto._setZoom = function (zooms) {\n    var nextZoom = zooms.zoom,\n        nextGuidesZoom = zooms.guidesZoom;\n    var hasZoom = !!this.props.zoom;\n    var hasGuidesZoom = !!this.props.guidesZoom;\n\n    if (hasGuidesZoom) {\n      if (nextGuidesZoom) {\n        this._guidesZoom = nextGuidesZoom;\n      }\n    } else {\n      if (nextGuidesZoom) {\n        this._zoom = nextGuidesZoom;\n        this._guidesZoom = nextGuidesZoom;\n      }\n\n      if (nextZoom) {\n        this._guidesZoom = nextZoom;\n      }\n    }\n\n    if (nextZoom) {\n      this._zoom = nextZoom;\n    }\n  };\n\n  Guides.defaultProps = {\n    className: \"\",\n    type: \"horizontal\",\n    zoom: 1,\n    guidesZoom: 0,\n    style: {},\n    snapThreshold: 5,\n    snaps: [],\n    digit: 0,\n    onClickRuler: function () {},\n    onChangeGuides: function () {},\n    onRequestScroll: function () {},\n    onDragStart: function () {},\n    onDrag: function () {},\n    onDragEnd: function () {},\n    displayDragPos: false,\n    dragPosFormat: function (v) {\n      return v;\n    },\n    defaultGuides: [],\n    lockGuides: false,\n    showGuides: true,\n    guideStyle: {},\n    dragGuideStyle: {},\n    guidePosStyle: {},\n    defaultGuidesPos: 0\n  };\n  return Guides;\n}(PureComponent);\n\nexport default Guides;\nexport { EVENTS, METHODS, PROPERTIES };\n//# sourceMappingURL=guides.esm.js.map\n","import Guides, * as others from \"./index.esm\";\n\nfor (const name in others) {\n    (Guides as any)[name] = others[name];\n}\n\nexport default Guides;\n","import {\n    PROPERTIES as GUIDES_PROPERTIES,\n    METHODS as GUIDES_METHODS,\n    EVENTS as GUIDES_EVENTS,\n} from \"@scena/react-guides\";\nimport {\n    GuidesOptions,\n} from \"@scena/react-guides/declaration/types\";\nexport const PROPERTIES: Array<keyof GuidesOptions> = GUIDES_PROPERTIES;\n\nexport const METHODS = GUIDES_METHODS as readonly string[];\n\nexport const EVENTS = GUIDES_EVENTS as readonly string[];\n","import * as React from \"react\";\nimport { ref } from \"framework-utils\";\nimport ReactGuides from \"@scena/react-guides\";\nimport { GuidesOptions } from \"@scena/react-guides/declaration/types\";\n\nexport interface InnerGuidesProps extends GuidesOptions {\n    container?: HTMLElement;\n}\nexport default class InnerGuides extends React.Component<InnerGuidesProps, InnerGuidesProps> {\n    public state: InnerGuidesProps = {};\n    public guides: ReactGuides;\n    constructor(props: InnerGuidesProps) {\n        super(props);\n        this.state = this.props;\n    }\n    public render() {\n        return <ReactGuides ref={ref(this, \"guides\")} {...this.state} />;\n    }\n}\n","import GuidesManager from \"./GuidesManager\";\n\nexport default class Guides extends GuidesManager {}\n","import { ref, Properties } from \"framework-utils\";\nimport * as React from \"react\";\nimport { PROPERTIES, METHODS, EVENTS } from \"./consts\";\nimport { GuidesInterface, GuidesEvents, GuidesOptions } from \"@scena/react-guides/declaration/types\";\nimport InnerGuides from \"./InnerGuides\";\nimport EventEmitter from \"@scena/event-emitter\";\nimport { camelize } from \"@daybrush/utils\";\nimport { ContainerProvider, renderSelf } from \"croact\";\n\n@Properties(METHODS as any, (prototype, property) => {\n    if (prototype[property]) {\n        return;\n    }\n    prototype[property] = function(...args) {\n        const self = this.getInnerGuides();\n\n        if (!self || !self[property]) {\n            return;\n        }\n        return self[property](...args);\n    };\n})\n@Properties(PROPERTIES, (prototype, property) => {\n    Object.defineProperty(prototype, property, {\n        get() {\n            return this.getInnerGuides().props[property];\n        },\n        set(value) {\n            this.innerGuides.setState({\n                [property]: value,\n            });\n        },\n        enumerable: true,\n        configurable: true,\n    });\n})\n/**\n * @sort 1\n * @extends EventEmitter\n */\nclass Guides extends EventEmitter<GuidesEvents> {\n    private containerProvider: ContainerProvider | null = null;\n    private selfElement: HTMLElement | null = null;\n    private _warp = false;\n    private innerGuides!: InnerGuides;\n    /**\n     * @sort 1\n     * @param - guides' container\n     * @param {$ts:Partial<Guides.GuidesOptions>} - guides' options\n     */\n    constructor(container: HTMLElement, options: Partial<GuidesOptions> = {}) {\n        super();\n        const events: any = {};\n\n        EVENTS.forEach(name => {\n            events[camelize(`on ${name}`)] = (e: any) => this.trigger(name as any, e);\n        });\n        let selfElement!: HTMLElement;\n\n        if (options.warpSelf) {\n            delete options.warpSelf;\n            this._warp = true;\n            selfElement = container;\n        } else {\n            selfElement = document.createElement(\"div\");\n            container.appendChild(selfElement);\n        }\n        this.containerProvider = renderSelf(\n            <InnerGuides ref={ref(this, \"innerGuides\")}\n                {...events}\n                {...options} />,\n            selfElement,\n        );\n    }\n    /**\n     * @param state\n     * @param callback\n     */\n    public setState(state: Partial<GuidesOptions>, callback?: () => void) {\n        this.innerGuides.setState(state, callback);\n    }\n    /**\n     * @param callback\n     */\n    public forceUpdate(callback?: () => void) {\n        this.innerGuides.forceUpdate(callback);\n    }\n    /**\n     * destroy guides\n     */\n    public destroy() {\n        const selfElement = this.selfElement!;\n\n        renderSelf(\n            null,\n            selfElement!,\n            this.containerProvider,\n        );\n        if (!this._warp) {\n            selfElement?.parentElement?.removeChild(selfElement);\n        }\n        this.selfElement = null;\n        this.innerGuides = null;\n    }\n    private getInnerGuides() {\n        return this.innerGuides.guides;\n    }\n}\ninterface Guides extends GuidesInterface {}\n\nexport default Guides;\n"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__assign","assign","t","s","i","n","arguments","length","apply","this","__spreadArray","to","from","pack","ar","l","slice","concat","prefix","classNames","_i","name","ADDER","GUIDES","GUIDE","DRAGGING","DISPLAY_DRAG","GUIDES_CSS","PROPERTIES","PROPERTIES$1","GuidesElement","Guides","_super","__extends","TypeError","String","__","constructor","props","_this","state","guides","scrollPos","managerRef","createRef","guideElements","_isFirstMove","_zoom","_guidesZoom","_observer","onDragStart","e","datas","inputEvent","movePos","dragElement","target","gesto","isFlag","stopPropagation","preventDefault","_startDragScroll","_onDrag","nextPos","onDrag","_dragScroll","_endDragScroll","onDragEnd","isDouble","distX","distY","pos","_a","onChangeGuides","displayDragPos","digit","lockGuides","guidesOffset","zoom","guidePos","parseFloat","toFixed","baseScrollPos","displayElement","style","cssText","fromRuler","onClickRuler","indexOf","setState","index","isAdd","isRemove","isChange","index_1","getAttribute","isRemove_1","isChange_1","guideIndex","splice","nextGuides","_onCheck","resize","defaultGuides","defaultGuidesPos","create","__proto","render","className","type","guidesZoom","rulerStyle","cspNonce","dragGuideStyle","_b","guidePosStyle","translateName","getTranslateName","rulerProps","forEach","console","log","createElement","ref","Ruler","transform","renderGuides","drawRuler","options","ruler","draw","showGuides","guideStyle","displayGuidePos","guidePosFormat","dragPosFormat","v","map","key","data-index","data-pos","componentDidMount","Gesto","current","container","document","body","on","stop","canvasElement","guidesElement","isHorizontal","originRect","originElement","getBoundingClientRect","matrix","getDistElementMatrix","offsetPos","calculateMatrixDist","clientX","left","clientY","top","isLockAdd","offsetLeft","offsetTop","isLockRemove","isLockChange","adderElement","useResizeObserver","ResizeObserver","observe","box","getRulerElement","componentWillUnmount","unset","disconnect","componentDidUpdate","prevProps","loadGuides","getGuides","scrollGuides","nextZoom","_setZoom","el","display","zoomTo","nextGuidesZoom","scroll","getRulerScrollPos","getGuideScrollPos","getElement","getScrollPos","snaps","snapThreshold","matrixPos","offsetX","offsetY","guidesZoomOffset","Math","round","guideSnaps","sort","a","abs","join","innerHTML","setAttribute","dragScroll","scrollOptions","DragScroll","_c","direction","onRequestScroll","scrollBy","dragStart","drag","dragEnd","zooms","defaultProps","PureComponent","GUIDES_PROPERTIES","METHODS","EVENTS","React","ReactGuides","selfElement","events","trigger","warpSelf","_warp","appendChild","containerProvider","renderSelf","InnerGuides","callback","innerGuides","forceUpdate","parentElement","removeChild","Properties","property","args","self","getInnerGuides","defineProperty","get","set","value","enumerable","configurable","EventEmitter","others"],"mappings":"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"}