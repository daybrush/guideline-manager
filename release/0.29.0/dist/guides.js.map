{"version":3,"file":"guides.js","sources":["../../react-guides/dist/guides.esm.js","../src/consts.ts","../src/InnerGuides.tsx","../src/GuidesManager.tsx","../src/Guides.tsx","../src/index.umd.ts"],"sourcesContent":["/*\nCopyright (c) 2019 Daybrush\nname: @scena/react-guides\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/guides/blob/master/packages/react-guides\nversion: 0.28.0\n*/\nimport { createElement, createRef, PureComponent } from 'react';\nimport Ruler, { PROPERTIES as PROPERTIES$1 } from '@scena/react-ruler';\nimport { prefixNames, prefixCSS, ref, refs } from 'framework-utils';\nimport DragScroll from '@scena/dragscroll';\nimport Gesto from 'gesto';\nimport { styled } from 'react-css-styled';\nimport { hasClass, addClass, removeClass } from '@daybrush/utils';\nimport { getDistElementMatrix, calculateMatrixDist } from 'css-to-mat';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\nfunction __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nfunction prefix() {\n  var classNames = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    classNames[_i] = arguments[_i];\n  }\n\n  return prefixNames.apply(void 0, __spreadArray([\"scena-guides-\"], classNames, false));\n}\n\nvar ADDER = prefix(\"guide\", \"adder\");\nvar GUIDES = prefix(\"guides\");\nvar GUIDE = prefix(\"guide\");\nvar DRAGGING = prefix(\"dragging\");\nvar DISPLAY_DRAG = prefix(\"display-drag\");\nvar GUIDES_CSS = prefixCSS(\"scena-guides-\", \"\\n{\\n    position: relative;\\n    width: 100%;\\n    height: 100%;\\n}\\ncanvas {\\n    position: relative;\\n}\\n.guide-origin {\\n    position: absolute;\\n    width: 1px;\\n    height: 1px;\\n    top: 0;\\n    left: 0;\\n    opacity: 0;\\n}\\n.guides {\\n    position: absolute;\\n    bottom: 0;\\n    right: 0;\\n    will-change: transform;\\n    z-index: 2000;\\n}\\n.guide-pos {\\n    position: absolute;\\n    font-weight: bold;\\n    font-size: 12px;\\n    color: #f33;\\n}\\n.horizontal .guide-pos {\\n    bottom: 100%;\\n    left: 50%;\\n    transform: translate(-50%);\\n}\\n.vertical .guide-pos {\\n    left: calc(100% + 2px);\\n    top: 50%;\\n    transform: translateY(-50%);\\n}\\n.display-drag {\\n    position: absolute;\\n    will-change: transform;\\n    z-index: 2000;\\n    font-weight: bold;\\n    font-size: 12px;\\n    display: none;\\n    left: 20px;\\n    top: -20px;\\n    color: #f33;\\n}\\n:host.horizontal .guides {\\n    width: 100%;\\n    height: 0;\\n}\\n:host.vertical .guides {\\n    height: 100%;\\n    width: 0;\\n}\\n:host.horizontal canvas {\\n    cursor: ns-resize;\\n}\\n:host.vertical canvas {\\n    cursor: ew-resize;\\n}\\n.guide {\\n    position: absolute;\\n    background: #f33;\\n    z-index: 2;\\n}\\n.guide.dragging:before {\\n    position: absolute;\\n    content: \\\"\\\";\\n    width: 100%;\\n    height: 100%;\\n    top: 50%;\\n    left: 50%;\\n    transform: translate(-50%, -50%);\\n}\\n:host.horizontal .guide {\\n    width: 100%;\\n    height: 1px;\\n    cursor: row-resize;\\n}\\n:host.vertical .guide {\\n    width: 1px;\\n    height: 100%;\\n    cursor: col-resize;\\n}\\n.mobile :host.horizontal .guide {\\n    transform: scale(1, 2);\\n}\\n.mobile :host.vertical .guide {\\n    transform: scale(2, 1);\\n}\\n:host.horizontal .guide:before {\\n    height: 20px;\\n}\\n:host.vertical .guide:before {\\n    width: 20px;\\n}\\n.adder {\\n    display: none;\\n}\\n.adder.dragging {\\n    display: block;\\n}\\n\");\nvar PROPERTIES = __spreadArray([\"className\", \"rulerStyle\", 'snapThreshold', \"snaps\", \"displayDragPos\", \"cspNonce\", 'dragPosFormat', \"defaultGuides\", \"showGuides\", \"scrollOptions\", \"guideStyle\", \"guidesOffset\", \"digit\", \"defaultGuidesPos\", \"dragGuideStyle\", \"displayGuidePos\", \"guidePosFormat\", \"guidePosStyle\", \"lockGuides\", \"guidesZoom\"], PROPERTIES$1, true);\nvar METHODS = [\"getGuides\", \"loadGuides\", \"scroll\", \"scrollGuides\", \"resize\", \"getElement\", \"getRulerElement\", \"forceUpdate\", \"getRulerScrollPos\", \"getGuideScrollPos\", \"zoomTo\", \"drawRuler\"];\nvar EVENTS = [\"changeGuides\", \"requestScroll\", \"dragStart\", \"drag\", \"dragEnd\", \"clickRuler\"];\n\nvar GuidesElement = styled(\"div\", GUIDES_CSS);\n\nvar Guides =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(Guides, _super);\n\n  function Guides(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = {\n      guides: []\n    };\n    _this.scrollPos = 0;\n    _this.managerRef = createRef();\n    _this.guideElements = [];\n    _this._isFirstMove = false;\n    _this._zoom = 1;\n    _this._guidesZoom = 1;\n    _this._observer = null;\n\n    _this.onDragStart = function (e) {\n      var datas = e.datas,\n          inputEvent = e.inputEvent;\n      _this._isFirstMove = true;\n\n      _this.movePos(e);\n      /**\n       * When the drag starts, the dragStart event is called.\n       * @memberof Guides\n       * @event dragStart\n       * @param {OnDragStart} - Parameters for the dragStart event\n       */\n\n\n      _this.props.onDragStart(__assign(__assign({}, e), {\n        dragElement: datas.target\n      }));\n\n      if (!_this.gesto.isFlag()) {\n        return;\n      }\n\n      inputEvent.stopPropagation();\n      inputEvent.preventDefault();\n\n      _this._startDragScroll(e);\n    };\n\n    _this._onDrag = function (e) {\n      if (_this._isFirstMove) {\n        _this._isFirstMove = false;\n        addClass(e.datas.target, DRAGGING);\n      }\n\n      var nextPos = _this.movePos(e);\n      /**\n       * When dragging, the drag event is called.\n       * @memberof Guides\n       * @event drag\n       * @param {OnDrag} - Parameters for the drag event\n       */\n\n\n      _this.props.onDrag(__assign(__assign({}, e), {\n        dragElement: e.datas.target\n      }));\n\n      if (!_this.gesto.isFlag()) {\n        _this._endDragScroll(e);\n\n        return;\n      }\n\n      _this._dragScroll(e);\n\n      return nextPos;\n    };\n\n    _this.onDragEnd = function (e) {\n      var datas = e.datas,\n          isDouble = e.isDouble,\n          distX = e.distX,\n          distY = e.distY;\n\n      var pos = _this.movePos(e);\n\n      var guides = _this.state.guides;\n      var _a = _this.props,\n          onChangeGuides = _a.onChangeGuides,\n          displayDragPos = _a.displayDragPos,\n          digit = _a.digit,\n          lockGuides = _a.lockGuides,\n          guidesOffset = _a.guidesOffset;\n      var zoom = _this._zoom;\n      var guidePos = parseFloat((pos / zoom).toFixed(digit || 0));\n      var baseScrollPos = _this.scrollPos - (guidesOffset || 0);\n\n      if (displayDragPos) {\n        _this.displayElement.style.cssText += \"display: none;\";\n      }\n\n      removeClass(datas.target, DRAGGING);\n      /**\n       * When the drag finishes, the dragEnd event is called.\n       * @memberof Guides\n       * @event dragEnd\n       * @param {OnDragEnd} - Parameters for the dragEnd event\n       */\n\n      _this.props.onDragEnd(__assign(__assign({}, e), {\n        dragElement: datas.target\n      }));\n\n      _this._endDragScroll(e);\n\n      if (datas.fromRuler) {\n        if (_this._isFirstMove) {\n          /**\n           * When click the ruler, the click ruler is called.\n           * @memberof Guides\n           * @event clickRuler\n           * @param {OnClickRuler} - Parameters for the clickRuler event\n           */\n          _this.props.onClickRuler(__assign(__assign({}, e), {\n            pos: 0\n          }));\n        }\n\n        if (guidePos >= baseScrollPos && guides.indexOf(guidePos) < 0) {\n          _this.setState({\n            guides: __spreadArray(__spreadArray([], guides, true), [guidePos], false)\n          }, function () {\n            /**\n             * The `changeGuides` event occurs when the guideline is added / removed / changed.\n             * @memberof Guides\n             * @event changeGuides\n             * @param {OnChangeGuides} - Parameters for the changeGuides event\n             */\n            onChangeGuides({\n              guides: _this.state.guides,\n              distX: distX,\n              distY: distY,\n              index: guides.length,\n              isAdd: true,\n              isRemove: false,\n              isChange: false\n            });\n          });\n        }\n      } else {\n        var index_1 = parseFloat(datas.target.getAttribute(\"data-index\"));\n        var isRemove_1 = false;\n        var isChange_1 = false;\n        guides = __spreadArray([], guides, true);\n        var guideIndex = guides.indexOf(guidePos);\n\n        if (isDouble || guidePos < baseScrollPos || guideIndex > -1 && guideIndex !== index_1) {\n          if (lockGuides && (lockGuides === true || lockGuides.indexOf(\"remove\") > -1)) {\n            return;\n          }\n\n          guides.splice(index_1, 1);\n          isRemove_1 = true;\n        } else if (guideIndex > -1) {\n          return;\n        } else {\n          if (lockGuides && (lockGuides === true || lockGuides.indexOf(\"change\") > -1)) {\n            return;\n          }\n\n          guides[index_1] = guidePos;\n          isChange_1 = true;\n        }\n\n        _this.setState({\n          guides: guides\n        }, function () {\n          var nextGuides = _this.state.guides;\n          onChangeGuides({\n            distX: distX,\n            distY: distY,\n            guides: nextGuides,\n            isAdd: false,\n            index: index_1,\n            isChange: isChange_1,\n            isRemove: isRemove_1\n          });\n        });\n      }\n    };\n\n    _this._onCheck = function () {\n      _this.resize();\n    };\n\n    _this.state.guides = props.defaultGuides || [];\n    _this.scrollPos = props.defaultGuidesPos || 0;\n    return _this;\n  }\n\n  var __proto = Guides.prototype;\n\n  __proto.render = function () {\n    var _a = this.props,\n        className = _a.className,\n        type = _a.type,\n        zoom = _a.zoom,\n        guidesZoom = _a.guidesZoom,\n        style = _a.style,\n        rulerStyle = _a.rulerStyle,\n        displayDragPos = _a.displayDragPos,\n        cspNonce = _a.cspNonce,\n        dragGuideStyle = _a.dragGuideStyle,\n        _b = _a.guidePosStyle,\n        guidePosStyle = _b === void 0 ? {} : _b;\n    var props = this.props;\n    var translateName = this.getTranslateName();\n    var rulerProps = {};\n    PROPERTIES$1.forEach(function (name) {\n      if (name === \"style\" || name === \"warpSelf\" || name === \"useResizeObserver\") {\n        return;\n      }\n\n      rulerProps[name] = props[name];\n    });\n    this._zoom = zoom;\n    this._guidesZoom = guidesZoom || zoom;\n    console.log(type, zoom, guidesZoom);\n    return createElement(GuidesElement, {\n      ref: this.managerRef,\n      cspNonce: cspNonce,\n      className: \"\".concat(prefix(\"manager\", type), \" \").concat(className),\n      style: style\n    }, createElement(\"div\", {\n      className: prefix(\"guide-origin\"),\n      ref: ref(this, \"originElement\")\n    }), createElement(Ruler, __assign({\n      ref: ref(this, \"ruler\"),\n      style: rulerStyle\n    }, rulerProps)), createElement(\"div\", {\n      className: GUIDES,\n      ref: ref(this, \"guidesElement\"),\n      style: {\n        transform: \"\".concat(translateName, \"(\").concat(-this.scrollPos * this._guidesZoom, \"px)\")\n      }\n    }, displayDragPos && createElement(\"div\", {\n      className: DISPLAY_DRAG,\n      ref: ref(this, \"displayElement\"),\n      style: guidePosStyle || {}\n    }), createElement(\"div\", {\n      className: ADDER,\n      ref: ref(this, \"adderElement\"),\n      style: dragGuideStyle\n    }), this.renderGuides()));\n  };\n  /**\n   * Draw ruler\n   */\n\n\n  __proto.drawRuler = function (options) {\n    this.ruler.draw(options);\n  };\n\n  __proto.renderGuides = function () {\n    var _this = this;\n\n    var props = this.props;\n    var _a = props,\n        type = _a.type,\n        showGuides = _a.showGuides,\n        guideStyle = _a.guideStyle,\n        displayGuidePos = _a.displayGuidePos,\n        _b = _a.guidePosStyle,\n        guidePosStyle = _b === void 0 ? {} : _b,\n        guidesOffset = _a.guidesOffset;\n    var zoom = this._guidesZoom;\n    var translateName = this.getTranslateName();\n    var guides = this.state.guides;\n\n    var guidePosFormat = props.guidePosFormat || props.dragPosFormat || function (v) {\n      return v;\n    };\n\n    this.guideElements = [];\n\n    if (showGuides) {\n      return guides.map(function (pos, i) {\n        var guidePos = pos + (guidesOffset || 0);\n        return createElement(\"div\", {\n          className: prefix(\"guide\", type),\n          ref: refs(_this, \"guideElements\", i),\n          key: i,\n          \"data-index\": i,\n          \"data-pos\": pos,\n          style: __assign(__assign({}, guideStyle), {\n            transform: \"\".concat(translateName, \"(\").concat(guidePos * zoom, \"px) translateZ(0px)\")\n          })\n        }, displayGuidePos && createElement(\"div\", {\n          className: prefix(\"guide-pos\"),\n          style: guidePosStyle || {}\n        }, guidePosFormat(pos)));\n      });\n    }\n\n    return;\n  };\n\n  __proto.componentDidMount = function () {\n    var _this = this;\n\n    this.gesto = new Gesto(this.managerRef.current, {\n      container: document.body\n    }).on(\"dragStart\", function (e) {\n      var _a = _this.props,\n          type = _a.type,\n          lockGuides = _a.lockGuides;\n      var zoom = _this._guidesZoom;\n\n      if (lockGuides === true) {\n        e.stop();\n        return;\n      }\n\n      var inputEvent = e.inputEvent;\n      var target = inputEvent.target;\n      var datas = e.datas;\n      var canvasElement = _this.ruler.canvasElement;\n      var guidesElement = _this.guidesElement;\n      var isHorizontal = type === \"horizontal\";\n\n      var originRect = _this.originElement.getBoundingClientRect();\n\n      var matrix = getDistElementMatrix(_this.managerRef.current);\n      var offsetPos = calculateMatrixDist(matrix, [e.clientX - originRect.left, e.clientY - originRect.top]);\n      offsetPos[0] -= guidesElement.offsetLeft;\n      offsetPos[1] -= guidesElement.offsetTop;\n      offsetPos[isHorizontal ? 1 : 0] += _this.scrollPos * zoom;\n      datas.offsetPos = offsetPos;\n      datas.matrix = matrix;\n      var isLockAdd = lockGuides && lockGuides.indexOf(\"add\") > -1;\n      var isLockRemove = lockGuides && lockGuides.indexOf(\"remove\") > -1;\n      var isLockChange = lockGuides && lockGuides.indexOf(\"change\") > -1;\n\n      if (target === canvasElement) {\n        if (isLockAdd) {\n          e.stop();\n          return;\n        }\n\n        datas.fromRuler = true;\n        datas.target = _this.adderElement; // add\n      } else if (hasClass(target, GUIDE)) {\n        if (isLockRemove && isLockChange) {\n          e.stop();\n          return;\n        }\n\n        datas.target = target; // change\n      } else {\n        e.stop();\n        return false;\n      }\n\n      _this.onDragStart(e);\n    }).on(\"drag\", this._onDrag).on(\"dragEnd\", this.onDragEnd);\n\n    if (this.props.useResizeObserver) {\n      this._observer = new ResizeObserver(this._onCheck);\n\n      this._observer.observe(this.guidesElement, {\n        box: \"border-box\"\n      });\n\n      this._observer.observe(this.getRulerElement(), {\n        box: \"border-box\"\n      });\n    } else {\n      this._onCheck();\n    }\n  };\n\n  __proto.componentWillUnmount = function () {\n    var _a;\n\n    this.gesto.unset();\n    (_a = this._observer) === null || _a === void 0 ? void 0 : _a.disconnect();\n  };\n\n  __proto.componentDidUpdate = function (prevProps) {\n    var nextGuides = this.props.defaultGuides;\n\n    if (prevProps.defaultGuides !== nextGuides) {\n      // to dynamically update guides from code rather than dragging guidelines\n      this.setState({\n        guides: nextGuides || []\n      });\n    }\n  };\n  /**\n   * Load the current guidelines.\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.loadGuides = function (guides) {\n    this.setState({\n      guides: guides\n    });\n  };\n  /**\n   * Get current guidelines.\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.getGuides = function () {\n    return this.state.guides;\n  };\n  /**\n   * Scroll the positions of the guidelines opposite the ruler.\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.scrollGuides = function (pos, nextZoom) {\n    if (nextZoom === void 0) {\n      nextZoom = this._guidesZoom;\n    }\n\n    this._setZoom({\n      guidesZoom: nextZoom\n    });\n\n    var translateName = this.getTranslateName();\n    var guidesElement = this.guidesElement;\n    this.scrollPos = pos;\n    guidesElement.style.transform = \"\".concat(translateName, \"(\").concat(-pos * nextZoom, \"px)\");\n    var guides = this.state.guides;\n    var guidesOffset = this.props.guidesOffset || 0;\n    this.guideElements.forEach(function (el, i) {\n      if (!el) {\n        return;\n      }\n\n      var guidePos = guides[i] + (guidesOffset || 0);\n      el.style.transform = \"\".concat(translateName, \"(\").concat(guidePos * nextZoom, \"px) translateZ(0px)\");\n      el.style.display = -pos + guidePos < 0 ? \"none\" : \"block\";\n    });\n  };\n  /**\n   * Set to the next zoom.\n   * @memberof Guides\n   * @since 0.22.0\n   * @param nextZoom - next zoom\n   */\n\n\n  __proto.zoomTo = function (nextZoom, nextGuidesZoom) {\n    if (nextGuidesZoom === void 0) {\n      nextGuidesZoom = nextZoom;\n    }\n\n    this.scroll(this.getRulerScrollPos(), nextZoom);\n    this.scrollGuides(this.getGuideScrollPos(), nextGuidesZoom);\n  };\n  /**\n   * Get Guides DOM Element\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.getElement = function () {\n    return this.managerRef.current;\n  };\n  /**\n   * Get Ruler DOM Element\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.getRulerElement = function () {\n    return this.ruler.canvasElement;\n  };\n  /**\n   * Scroll position of guides (horizontal: y, vertical: x)\n   */\n\n\n  __proto.getGuideScrollPos = function () {\n    return this.scrollPos;\n  };\n  /**\n   * Scroll position of the ruler (horizontal: x, vertical: y)\n   */\n\n\n  __proto.getRulerScrollPos = function () {\n    return this.ruler.getScrollPos();\n  };\n  /**\n   * Scroll the position of the ruler.\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.scroll = function (pos, nextZoom) {\n    if (nextZoom === void 0) {\n      nextZoom = this._zoom;\n    }\n\n    this._setZoom({\n      zoom: nextZoom\n    });\n\n    this.ruler.scroll(pos, nextZoom);\n  };\n  /**\n   * Recalculate the size of the ruler.\n   * @memberof Guides\n   * @instance\n   */\n\n\n  __proto.resize = function (nextZoom) {\n    if (nextZoom === void 0) {\n      nextZoom = this._zoom;\n    }\n\n    this._setZoom({\n      zoom: nextZoom\n    });\n\n    this.ruler.resize(nextZoom);\n  };\n\n  __proto.movePos = function (e) {\n    var datas = e.datas,\n        distX = e.distX,\n        distY = e.distY;\n    var props = this.props;\n    var type = props.type,\n        snaps = props.snaps,\n        snapThreshold = props.snapThreshold,\n        displayDragPos = props.displayDragPos,\n        digit = props.digit;\n    var guidesOffset = props.guidesOffset || 0;\n    var zoom = this._zoom;\n\n    var dragPosFormat = props.dragPosFormat || function (v) {\n      return v;\n    };\n\n    var isHorizontal = type === \"horizontal\";\n    var matrixPos = calculateMatrixDist(datas.matrix, [distX, distY]);\n    var offsetPos = datas.offsetPos;\n    var offsetX = matrixPos[0] + offsetPos[0];\n    var offsetY = matrixPos[1] + offsetPos[1];\n    var guidesZoomOffset = guidesOffset * zoom;\n    var nextPos = Math.round(isHorizontal ? offsetY : offsetX) - guidesOffset;\n    var guidePos = parseFloat((nextPos / zoom).toFixed(digit || 0));\n    var guideSnaps = snaps.slice().sort(function (a, b) {\n      return Math.abs(guidePos - a) - Math.abs(guidePos - b);\n    });\n\n    if (guideSnaps.length && Math.abs(guideSnaps[0] * zoom - nextPos) < snapThreshold) {\n      guidePos = guideSnaps[0];\n      nextPos = guidePos * zoom;\n    }\n\n    if (!datas.fromRuler || !this._isFirstMove) {\n      if (displayDragPos) {\n        var displayPos = type === \"horizontal\" ? [offsetX, nextPos + guidesZoomOffset] : [nextPos + guidesZoomOffset, offsetY];\n        this.displayElement.style.cssText += \"display: block;\" + \"transform: translate(-50%, -50%) \" + \"translate(\".concat(displayPos.map(function (v) {\n          return \"\".concat(v, \"px\");\n        }).join(\", \"), \")\");\n        this.displayElement.innerHTML = \"\".concat(dragPosFormat(guidePos));\n      }\n\n      var target = datas.target;\n      target.setAttribute(\"data-pos\", guidePos);\n      target.style.transform = \"\".concat(this.getTranslateName(), \"(\").concat(nextPos + guidesOffset * zoom, \"px)\");\n    }\n\n    return nextPos;\n  };\n\n  __proto.getTranslateName = function () {\n    return this.props.type === \"horizontal\" ? \"translateY\" : \"translateX\";\n  };\n\n  __proto._startDragScroll = function (e) {\n    var _this = this;\n\n    var scrollOptions = this.props.scrollOptions;\n\n    if (!scrollOptions) {\n      return;\n    }\n\n    var datas = e.datas;\n    var dragScroll = new DragScroll();\n    datas.dragScroll = dragScroll;\n    dragScroll.on(\"scroll\", function (_a) {\n      var _b, _c;\n\n      var container = _a.container,\n          direction = _a.direction;\n      /**\n       * If scroll can be triggered through drag, the `requestScroll` event is fired.\n       * @memberof Guides\n       * @event requestScroll\n       * @param {OnRequestScroll} - Parameters for the `requestScroll` event\n       */\n\n      (_c = (_b = _this.props).onRequestScroll) === null || _c === void 0 ? void 0 : _c.call(_b, {\n        container: container,\n        direction: direction\n      });\n    }).on(\"move\", function (_a) {\n      var offsetX = _a.offsetX,\n          offsetY = _a.offsetY,\n          inputEvent = _a.inputEvent;\n\n      _this.gesto.scrollBy(offsetX, offsetY, inputEvent.inputEvent, true);\n    });\n    dragScroll.dragStart(e, {\n      container: scrollOptions.container\n    });\n  };\n\n  __proto._dragScroll = function (e) {\n    var scrollOptions = this.props.scrollOptions;\n\n    if (!scrollOptions) {\n      return;\n    }\n\n    var dragScroll = e.datas.dragScroll;\n    dragScroll.drag(e, scrollOptions);\n  };\n\n  __proto._endDragScroll = function (e) {\n    var _a;\n\n    (_a = e.datas.dragScroll) === null || _a === void 0 ? void 0 : _a.dragEnd();\n    e.datas.dragScroll = null;\n  };\n\n  __proto._setZoom = function (zooms) {\n    var nextZoom = zooms.zoom,\n        nextGuidesZoom = zooms.guidesZoom;\n    var hasZoom = !!this.props.zoom;\n    var hasGuidesZoom = !!this.props.guidesZoom;\n\n    if (hasGuidesZoom) {\n      if (nextGuidesZoom) {\n        this._guidesZoom = nextGuidesZoom;\n      }\n    } else {\n      if (nextGuidesZoom) {\n        this._zoom = nextGuidesZoom;\n        this._guidesZoom = nextGuidesZoom;\n      }\n\n      if (nextZoom) {\n        this._guidesZoom = nextZoom;\n      }\n    }\n\n    if (nextZoom) {\n      this._zoom = nextZoom;\n    }\n  };\n\n  Guides.defaultProps = {\n    className: \"\",\n    type: \"horizontal\",\n    zoom: 1,\n    guidesZoom: 0,\n    style: {},\n    snapThreshold: 5,\n    snaps: [],\n    digit: 0,\n    onClickRuler: function () {},\n    onChangeGuides: function () {},\n    onRequestScroll: function () {},\n    onDragStart: function () {},\n    onDrag: function () {},\n    onDragEnd: function () {},\n    displayDragPos: false,\n    dragPosFormat: function (v) {\n      return v;\n    },\n    defaultGuides: [],\n    lockGuides: false,\n    showGuides: true,\n    guideStyle: {},\n    dragGuideStyle: {},\n    guidePosStyle: {},\n    defaultGuidesPos: 0\n  };\n  return Guides;\n}(PureComponent);\n\nexport default Guides;\nexport { EVENTS, METHODS, PROPERTIES };\n//# sourceMappingURL=guides.esm.js.map\n","import {\n    PROPERTIES as GUIDES_PROPERTIES,\n    METHODS as GUIDES_METHODS,\n    EVENTS as GUIDES_EVENTS,\n} from \"@scena/react-guides\";\nimport {\n    GuidesOptions,\n} from \"@scena/react-guides/declaration/types\";\nexport const PROPERTIES: Array<keyof GuidesOptions> = GUIDES_PROPERTIES;\n\nexport const METHODS = GUIDES_METHODS as readonly string[];\n\nexport const EVENTS = GUIDES_EVENTS as readonly string[];\n","import * as React from \"react\";\nimport { ref } from \"framework-utils\";\nimport ReactGuides from \"@scena/react-guides\";\nimport { GuidesOptions } from \"@scena/react-guides/declaration/types\";\n\nexport interface InnerGuidesProps extends GuidesOptions {\n    container?: HTMLElement;\n}\nexport default class InnerGuides extends React.Component<InnerGuidesProps, InnerGuidesProps> {\n    public state: InnerGuidesProps = {};\n    public guides: ReactGuides;\n    constructor(props: InnerGuidesProps) {\n        super(props);\n        this.state = this.props;\n    }\n    public render() {\n        return <ReactGuides ref={ref(this, \"guides\")} {...this.state} />;\n    }\n}\n","import { ref, Properties } from \"framework-utils\";\nimport * as React from \"react\";\nimport { PROPERTIES, METHODS, EVENTS } from \"./consts\";\nimport { GuidesInterface, GuidesEvents, GuidesOptions } from \"@scena/react-guides/declaration/types\";\nimport InnerGuides from \"./InnerGuides\";\nimport EventEmitter from \"@scena/event-emitter\";\nimport { camelize } from \"@daybrush/utils\";\nimport { ContainerProvider, renderSelf } from \"croact\";\n\n@Properties(METHODS as any, (prototype, property) => {\n    if (prototype[property]) {\n        return;\n    }\n    prototype[property] = function(...args) {\n        const self = this.getInnerGuides();\n\n        if (!self || !self[property]) {\n            return;\n        }\n        return self[property](...args);\n    };\n})\n@Properties(PROPERTIES, (prototype, property) => {\n    Object.defineProperty(prototype, property, {\n        get() {\n            return this.getInnerGuides().props[property];\n        },\n        set(value) {\n            this.innerGuides.setState({\n                [property]: value,\n            });\n        },\n        enumerable: true,\n        configurable: true,\n    });\n})\n/**\n * @sort 1\n * @extends EventEmitter\n */\nclass Guides extends EventEmitter<GuidesEvents> {\n    private containerProvider: ContainerProvider | null = null;\n    private selfElement: HTMLElement | null = null;\n    private _warp = false;\n    private innerGuides!: InnerGuides;\n    /**\n     * @sort 1\n     * @param - guides' container\n     * @param {$ts:Partial<Guides.GuidesOptions>} - guides' options\n     */\n    constructor(container: HTMLElement, options: Partial<GuidesOptions> = {}) {\n        super();\n        const events: any = {};\n\n        EVENTS.forEach(name => {\n            events[camelize(`on ${name}`)] = (e: any) => this.trigger(name as any, e);\n        });\n        let selfElement!: HTMLElement;\n\n        if (options.warpSelf) {\n            delete options.warpSelf;\n            this._warp = true;\n            selfElement = container;\n        } else {\n            selfElement = document.createElement(\"div\");\n            container.appendChild(selfElement);\n        }\n        this.containerProvider = renderSelf(\n            <InnerGuides ref={ref(this, \"innerGuides\")}\n                {...events}\n                {...options} />,\n            selfElement,\n        );\n    }\n    /**\n     * @param state\n     * @param callback\n     */\n    public setState(state: Partial<GuidesOptions>, callback?: () => void) {\n        this.innerGuides.setState(state, callback);\n    }\n    /**\n     * @param callback\n     */\n    public forceUpdate(callback?: () => void) {\n        this.innerGuides.forceUpdate(callback);\n    }\n    /**\n     * destroy guides\n     */\n    public destroy() {\n        const selfElement = this.selfElement!;\n\n        renderSelf(\n            null,\n            selfElement!,\n            this.containerProvider,\n        );\n        if (!this._warp) {\n            selfElement?.parentElement?.removeChild(selfElement);\n        }\n        this.selfElement = null;\n        this.innerGuides = null;\n    }\n    private getInnerGuides() {\n        return this.innerGuides.guides;\n    }\n}\ninterface Guides extends GuidesInterface {}\n\nexport default Guides;\n","import GuidesManager from \"./GuidesManager\";\n\nexport default class Guides extends GuidesManager {}\n","import Guides, * as others from \"./index.esm\";\n\nfor (const name in others) {\n    (Guides as any)[name] = others[name];\n}\n\nexport default Guides;\n"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__spreadArray","to","from","pack","l","ar","slice","concat","prefix","classNames","_i","prefixNames","ADDER","GUIDES","GUIDE","DRAGGING","DISPLAY_DRAG","GUIDES_CSS","prefixCSS","PROPERTIES","PROPERTIES$1","METHODS","EVENTS","GuidesElement","styled","Guides","_super","props","_this","state","guides","scrollPos","managerRef","createRef","guideElements","_isFirstMove","_zoom","_guidesZoom","_observer","onDragStart","e","datas","inputEvent","movePos","dragElement","target","gesto","isFlag","stopPropagation","preventDefault","_startDragScroll","_onDrag","addClass","nextPos","onDrag","_endDragScroll","_dragScroll","onDragEnd","isDouble","distX","distY","pos","_a","onChangeGuides","displayDragPos","digit","lockGuides","guidesOffset","zoom","guidePos","parseFloat","toFixed","baseScrollPos","displayElement","style","cssText","removeClass","fromRuler","onClickRuler","indexOf","setState","index","isAdd","isRemove","isChange","index_1","getAttribute","isRemove_1","isChange_1","guideIndex","splice","nextGuides","_onCheck","resize","defaultGuides","defaultGuidesPos","__proto","render","className","type","guidesZoom","rulerStyle","cspNonce","dragGuideStyle","_b","guidePosStyle","translateName","getTranslateName","rulerProps","forEach","name","console","log","createElement","ref","Ruler","transform","renderGuides","drawRuler","options","ruler","draw","showGuides","guideStyle","displayGuidePos","guidePosFormat","dragPosFormat","v","map","refs","key","componentDidMount","Gesto","current","container","document","body","on","stop","canvasElement","guidesElement","isHorizontal","originRect","originElement","getBoundingClientRect","matrix","getDistElementMatrix","offsetPos","calculateMatrixDist","clientX","left","clientY","top","offsetLeft","offsetTop","isLockAdd","isLockRemove","isLockChange","adderElement","hasClass","useResizeObserver","ResizeObserver","observe","box","getRulerElement","componentWillUnmount","unset","disconnect","componentDidUpdate","prevProps","loadGuides","getGuides","scrollGuides","nextZoom","_setZoom","el","display","zoomTo","nextGuidesZoom","scroll","getRulerScrollPos","getGuideScrollPos","getElement","getScrollPos","snaps","snapThreshold","matrixPos","offsetX","offsetY","guidesZoomOffset","Math","round","guideSnaps","sort","a","abs","displayPos","join","innerHTML","setAttribute","scrollOptions","dragScroll","DragScroll","_c","direction","onRequestScroll","scrollBy","dragStart","drag","dragEnd","zooms","hasZoom","hasGuidesZoom","defaultProps","PureComponent","GUIDES_PROPERTIES","GUIDES_METHODS","GUIDES_EVENTS","React","ReactGuides","events","camelize","trigger","selfElement","warpSelf","_warp","appendChild","containerProvider","renderSelf","InnerGuides","callback","innerGuides","forceUpdate","parentElement","removeChild","Properties","property","args","self","getInnerGuides","defineProperty","get","set","value","enumerable","configurable","EventEmitter","GuidesManager","others"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}